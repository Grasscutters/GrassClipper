# ! ВНИМАНИЕ !
Новый лаунчер, в число разработчиков которых входит и автор, находится в разработке. К сожалению, это означает, что автор не может посвятить время поддержке GrassClipper, поскольку он занят разработкой нового лаунчера. Однако, это не является чем-то плохим, поскольку новый лаунчер уже на текущий момент более стабилен и имеет больше функций. Если у Вас имеются проблемы с GrassClipper, автор рекомендует дождаться нового лаунчера.

# GrassClipper
[EN](README.md) | [PL](README_PL.md) | [ID](README_id.md) | RU

Экспериментальный лаунчер системы Grasscutter, предназначенный для быстрого переключения между официальными и приватными серверами.

[Скачать по ссылке](https://github.com/Grasscutters/GrassClipper/releases/) (Включает поддержку Windows 8+)

*\*Заметка: некоторые переводы лаунчера устарели, что может являться причиной появления непереведенного английского или вводящего в заблуждение текста в некоторых местах. Если вы заметили подобный недочет - не стесняйтесь создавать pull request!*

# Оглавление

* [Установка (для пользователей)](#установка-для-пользователей)
* [Установка (для разработчиков)](#установка-для-разработчиков)
* [TODO](#todo)
* [Общие проблемы](#имеются-проблемы)
  * [Установщик прокси-сервера не открывается/не работает](#ручная-установка-прокси)
  * [Исправление "белого экрана"](#исправление-белого-экрана)
  * [Ошибка 502](#ошибка-502)
  * [Ошибка 4206](#ошибка-4206)
  * [Бесконечная командная строка Windows](#бесконечная-командная-строка-windows)
  * [Неработающий Discord/Youtube](#discord-не-отправляет-сообщения-или-не-загружает-изображения-youtube-ведет-себя-странно)
  * [Нет соединения с интернетом](#мой-интернет-перестал-работать-после-закрытия-всего-перезагрузки-пк)
* [Языки и благодарность за перевод](#доступные-языки-и-благодарность-за-перевод)
* [Скриншоты](#скриншоты)

# Установка (для пользователей)

1. Скачайте zip-архив
2. Распакуйте данный архив в любое место
3. Запустите `GrassClipper.exe`, установите прокси-сервер, и укажите путь до exe-файла игры!

# Установка (для разработчиков)

0. Склонируйте (clone) данный репозиторий
1. Убедитесь в том, что у вас установлен [NodeJS](https://nodejs.org/en/download/).
2. Установите утилиту `neu` CLI: `npm install -g @neutralinojs/neu`
3. Установите зависимости: `setup_win.cmd`
4. Скомпилируйте и введите:
   * Для тестирования: `npm run dev`
   * Для продакшна: `npm run build`

# TODO

* Интерфейс/внутреннее устройство
  * [x] Пользовательский интерфейс
  * [x] Выбор между официальными и приватными серверами
  * [x] Ввод IP сервера
  * [x] Всякий изысканный CSS-стайлинг (вертикальное меню в стиле CoD: MW 2019 для выбора между официальными и приватными серверами? [См. здесь](https://charlieintel.com/wp-content/uploads/2020/11/MW-new-menu.png))
  * [x] Скрипт-killswitch (опционально)
  * [x] Автоматический запуск `install.cmd` при открытии в первый раз
  * [x] Автозагрузчик Grasscutter
  * [ ] Детектирование нахождения в папке, недоступной программе (например, `C:/Program Files`) и предупреждение об этом
  * [ ] Кастомные изображение для секции приватных серверов (каждый может создать pull request для их добавления!)
  * [x] Опциональное создание имени пользователя/пароля для серверов перед входом (еще не реализовано в Grasscutter)
  * [ ] Детектирование платформы и баш-скриптов
  * [ ] Интегрированный создатель баннеров
* Служба прокси
  * [x] Локальный прокси-сервер
  * [x] Перехват и модификация запросов GI наподобие Fiddler, пропуск остальных
  * [ ] Исправление ошибок Discord и YouTube при включенном прокси (возможно уже решено)

# Имеются проблемы?

Ниже приведены некоторые сценарии, с которыми вы можете столкнуться, и их решение.

# Ручная установка прокси

Если у вас возникли проблемы с установкой прокси-сервера, вы можете установить его вручную. Для этого:
1. Создайте папку с именем `ext` в папке GrassClipper, если ее еще не существует.
2. Скачайте и распакуйте содержимое [этого файла](https://snapshots.mitmproxy.org/7.0.4/mitmproxy-7.0.4-windows.zip) в папку `ext`
3. Два раза нажмите на `mitmdump.exe` и позвольте ему поработать несколько секунд для генерации сертификатов
4. Запустите эту команду от имени администратора: `certutil -addstore root "%USERPROFILE%\.mitmproxy\mitmproxy-ca-cert.cer"`
5. Теперь вы можете использовать GrassClipper как обычно!

## Исправление "белого экрана"

Столкнулись с "белым экраном"? [Убедитесь, что WebView2 установлен](https://developer.microsoft.com/en-us/microsoft-edge/webview2/#download)

Возможно, вам также придется запустить следующую команду от имени администратора:
`CheckNetIsolation.exe LoopbackExempt -a -n="Microsoft.Win32WebViewHost_cw5n1h2txyewy"`

Если в пути присутствуют китайские символы, то это также может привести к крашам! Работа над исправлением ведется.

Также, вы можете попробовать запустить программу в режиме совместимости с Windows 8.

Если все вышеперечисленное не сработало, вы можете запустить GrassClipper в режиме `chrome` или `browser` mode. Для этого:
* Создайте ярлык для `GrassClipper.exe`
* ПКМ на ярлыке, пункт `Свойства`
* В поле `Объект`, в самом конце, добавьте ` --mode=chrome` или ` --mode=browser`
  * `chrome` сработает только если у вас установлен Chrome. Это создаст окно Chrome
  * `browser` запустит GrassClipper, как вы могли догадаться, в вашем браузере по умолчанию
* Нажмите `Ok`
* С этого момента, запускайте GrassClipper используя этот ярлык!

## Ошибка 502

***Возможно, вы используете некорректный порт. Убедитесь, что в GrassClipper порт равен или 443, или ничему (не 0, именно пустому полю)***

1. Если вы используете локальный сервер, убедитесь в том, что локальный сервер запущен. Иначе, убедитесь, что сервер, к которому вы подключаетесь, запущен.

2. Если у вас есть возможность, [используйте тестовую (development) ветку Grasscutter](https://github.com/Grasscutters/Grasscutter/tree/development). Известно, что она лучше работает с GrassClipper.

Если у вас все еще наблюдается ошибка 502 при попытке входа на свой сервер, откройте файл конфигурации Grasscutter и добавьте следующее в разделе `DispatchServer`:

```json
"PublicPort": YOUR_PORT
```
где `YOUR_PORT` соответствует порту в поле `Port`. Скорее всего, это будет порт 443.

## Ошибка 4206

Убедитесь, что файл `keystore.p12` соответствует ветке Grasscutter (`stable` или `development`). Также убедитесь, что был задан правильный пароль в файле Grasscutter `config.json` (пустота для `stable`, "123456" для `development`).

## Бесконечная командная строка Windows

Если у вас возникают проблемы с бесконечной командной строкой Windows для любого из скриптов (таких, как установка прокси-сервера или запуск приватного сервера), убедитесь, что UAC (контроль учетных записей) установлен в любую из опций, требующую разрешения. Убедитесь, что ваш аккаунт пользователя может запускать от имени администратора.

## Discord не отправляет сообщения или не загружает изображения/Youtube ведет себя странно!

Похоже, что Discord/YouTube (и некоторые другие сервисы) не дружат с прокси-серверами. Возможно, вам придется отключить его путем или закрытия mitmdump, или отключения прокси в настройках прокси Windows.

## Мой интернет перестал работать после закрытия всего/перезагрузки ПК!

Скорее всего, лаунчер завершил работу некорректно, и потому не мог сбросить ваши настройки прокси до изначальной версии. Отключите прокси в настройказ прокси Windows.

# Доступные языки и благодарность за перевод

Спасибо всем переводчикам! <3

* ZH - nuoxianCN, Scirese & MrAru
* ZH-TW - Kimi & KormiMeiko
* PT-BR - na.na & actuallyeunha
* VIE - labalityowo & lunaticwhat
* ID - Iqrar99 & nautilust
* FR - linsorak & memetrollsXD
* ES - memetrollsXD
* ND - memetrollsXD
* RU - fitiskin
* TR - lilmayofuksu
* JP - conochy
* HD - Arikatsu
* PL - zakhil-dev
* TH - ongsalt
* KO - tsukiroku

# Скриншоты

![image](https://user-images.githubusercontent.com/25207995/164574276-645548c2-7ba6-47c3-8df4-77082003648f.png)
![image](https://user-images.githubusercontent.com/25207995/164393190-f7e6633c-60bd-4186-bf0c-30d9f30871f4.png)
![image](https://user-images.githubusercontent.com/25207995/164393040-4da72f29-6d59-4af4-bd60-072269f2ba2a.png)
![image](https://user-images.githubusercontent.com/25207995/164393024-56543ddf-7063-4c04-9a9f-0c6238f30e90.png)
![image](https://user-images.githubusercontent.com/25207995/164393118-de844e75-f9a2-491a-aea6-f2d563abecc7.png)
![image](https://user-images.githubusercontent.com/25207995/164882735-77aa535c-0e93-4b32-af7c-f8b59888257a.png)
![image](https://user-images.githubusercontent.com/25207995/164882716-c9f16cd0-c0b6-4c0a-ae9e-4c95da9ef7f5.png)


